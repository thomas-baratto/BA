Job started on argon-gtx
Job ID: 556
Working directory: /home/barattts/lavoltabuona/BA
---
Starting Python script...
Unable to determine the device handle for GPU0000:61:00.0: Unknown Error
Running: python run_optuna.py --target all --skip-optuna
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-07 18:47:46,007 - INFO - Using device: cuda
2025-11-07 18:47:46,009 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-07 18:47:46,009 - INFO - Skip Optuna: True
2025-11-07 18:47:46,009 - INFO - Skipping Optuna. Loading best parameters from study: nn_study_Area_Iso_distance_Iso_width...
2025-11-07 18:47:47,016 - INFO - Successfully loaded best parameters from trial 587:
2025-11-07 18:47:47,040 - INFO -   Best value (RMSE): 0.000741
2025-11-07 18:47:53,647 - INFO -   Number of trials completed: 2986
2025-11-07 18:47:53,647 - INFO -   Optimized parameters:
2025-11-07 18:47:53,769 - INFO -     batch_size: 64
2025-11-07 18:47:53,769 - INFO -     learning_rate: 0.0011537697650495493
2025-11-07 18:47:53,769 - INFO -     nr_hidden_layers: 3
2025-11-07 18:47:53,769 - INFO -     nr_neurons: 152
2025-11-07 18:47:53,769 - INFO -     dropout_rate: 0.0007055009826885291
2025-11-07 18:47:53,769 - INFO -     weight_decay: 1.3078059031292613e-05
2025-11-07 18:47:53,769 - INFO -     activation_name: GELU
2025-11-07 18:47:53,769 - INFO -     loss_criterion: L1
2025-11-07 18:47:53,769 - INFO - Training final model with parameters...
2025-11-07 18:47:53,769 - INFO - Starting main training for labels ['Area', 'Iso_distance', 'Iso_width']...
2025-11-07 18:47:56,292 - INFO - Final training: 47896 train samples, 11975 val samples, 25660 test samples.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:734: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
2025-11-07 18:47:56,659 - INFO - Using L1Loss (MAE)
2025-11-07 18:47:58,550 - INFO - Using CosineAnnealingLR with T_max=1000
2025-11-07 18:47:58,550 - INFO - Added warmup for 10 epochs
2025-11-07 18:47:58,600 - INFO - Starting final training loop for max 1000 epochs (Patience=100)...
2025-11-07 18:48:00,778 - INFO - Epoch [1/1000], Train Loss: 0.130433, Val Loss: 0.068609, LR: 0.000219
2025-11-07 18:48:00,780 - INFO - New best model found at epoch 1 with val_loss: 0.068609
2025-11-07 18:48:02,759 - INFO - New best model found at epoch 2 with val_loss: 0.066054
2025-11-07 18:48:06,724 - INFO - New best model found at epoch 4 with val_loss: 0.060308
2025-11-07 18:48:08,725 - INFO - New best model found at epoch 5 with val_loss: 0.053875
2025-11-07 18:48:10,712 - INFO - New best model found at epoch 6 with val_loss: 0.050376
2025-11-07 18:48:12,689 - INFO - New best model found at epoch 7 with val_loss: 0.035634
2025-11-07 18:48:14,676 - INFO - New best model found at epoch 8 with val_loss: 0.031406
2025-11-07 18:48:16,663 - INFO - New best model found at epoch 9 with val_loss: 0.028255
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:243: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-11-07 18:48:18,645 - INFO - New best model found at epoch 10 with val_loss: 0.028126
2025-11-07 18:48:20,630 - INFO - New best model found at epoch 11 with val_loss: 0.021404
2025-11-07 18:48:24,613 - INFO - New best model found at epoch 13 with val_loss: 0.017833
2025-11-07 18:48:30,564 - INFO - New best model found at epoch 16 with val_loss: 0.015493
2025-11-07 18:48:34,562 - INFO - New best model found at epoch 18 with val_loss: 0.011994
2025-11-07 18:48:36,564 - INFO - New best model found at epoch 19 with val_loss: 0.009620
2025-11-07 18:48:38,564 - INFO - New best model found at epoch 20 with val_loss: 0.006892
2025-11-07 18:48:50,469 - INFO - New best model found at epoch 26 with val_loss: 0.006407
2025-11-07 18:48:54,442 - INFO - New best model found at epoch 28 with val_loss: 0.005309
2025-11-07 18:49:02,368 - INFO - New best model found at epoch 32 with val_loss: 0.004918
2025-11-07 18:49:08,323 - INFO - New best model found at epoch 35 with val_loss: 0.004715
2025-11-07 18:49:14,259 - INFO - New best model found at epoch 38 with val_loss: 0.004058
2025-11-07 18:49:24,171 - INFO - New best model found at epoch 43 with val_loss: 0.003517
2025-11-07 18:49:38,024 - INFO - Epoch [50/1000], Train Loss: 0.005407, Val Loss: 0.003636, LR: 0.001149
2025-11-07 18:49:40,013 - INFO - New best model found at epoch 51 with val_loss: 0.003431
2025-11-07 18:49:49,830 - INFO - New best model found at epoch 55 with val_loss: 0.003315
2025-11-07 18:50:26,631 - INFO - New best model found at epoch 69 with val_loss: 0.003240
2025-11-07 18:50:32,582 - INFO - New best model found at epoch 72 with val_loss: 0.002580
2025-11-07 18:50:44,470 - INFO - New best model found at epoch 78 with val_loss: 0.002492
2025-11-07 18:51:27,998 - INFO - Epoch [100/1000], Train Loss: 0.004376, Val Loss: 0.003445, LR: 0.001131
2025-11-07 18:51:43,843 - INFO - New best model found at epoch 108 with val_loss: 0.002131
2025-11-07 18:53:07,088 - INFO - Epoch [150/1000], Train Loss: 0.003696, Val Loss: 0.002865, LR: 0.001099
2025-11-07 18:54:10,462 - INFO - New best model found at epoch 182 with val_loss: 0.001889
2025-11-07 18:54:18,376 - INFO - New best model found at epoch 186 with val_loss: 0.001717
2025-11-07 18:54:46,101 - INFO - Epoch [200/1000], Train Loss: 0.003272, Val Loss: 0.002499, LR: 0.001054
2025-11-07 18:54:48,089 - INFO - New best model found at epoch 201 with val_loss: 0.001630
2025-11-07 18:55:33,908 - INFO - New best model found at epoch 224 with val_loss: 0.001605
2025-11-07 18:55:37,878 - INFO - New best model found at epoch 226 with val_loss: 0.001461
2025-11-07 18:56:25,416 - INFO - Epoch [250/1000], Train Loss: 0.003020, Val Loss: 0.002722, LR: 0.000997
2025-11-07 18:57:16,590 - INFO - New best model found at epoch 274 with val_loss: 0.001367
2025-11-07 18:57:30,410 - INFO - New best model found at epoch 281 with val_loss: 0.001359
2025-11-07 18:58:08,009 - INFO - Epoch [300/1000], Train Loss: 0.002756, Val Loss: 0.002430, LR: 0.000930
2025-11-07 18:58:29,756 - INFO - New best model found at epoch 311 with val_loss: 0.001246
2025-11-07 18:59:46,995 - INFO - Epoch [350/1000], Train Loss: 0.002580, Val Loss: 0.002725, LR: 0.000855
2025-11-07 19:00:32,511 - INFO - New best model found at epoch 373 with val_loss: 0.001079
2025-11-07 19:01:02,757 - INFO - New best model found at epoch 389 with val_loss: 0.001072
2025-11-07 19:01:23,378 - INFO - Epoch [400/1000], Train Loss: 0.002344, Val Loss: 0.001307, LR: 0.000772
2025-11-07 19:02:43,642 - INFO - New best model found at epoch 442 with val_loss: 0.000867
2025-11-07 19:02:58,664 - INFO - Epoch [450/1000], Train Loss: 0.002074, Val Loss: 0.001159, LR: 0.000685
2025-11-07 19:04:15,561 - INFO - New best model found at epoch 491 with val_loss: 0.000828
2025-11-07 19:04:32,413 - INFO - Epoch [500/1000], Train Loss: 0.001892, Val Loss: 0.001360, LR: 0.000595
2025-11-07 19:05:28,669 - INFO - New best model found at epoch 530 with val_loss: 0.000773
2025-11-07 19:06:06,096 - INFO - Epoch [550/1000], Train Loss: 0.001681, Val Loss: 0.000898, LR: 0.000505
2025-11-07 19:06:29,141 - INFO - New best model found at epoch 561 with val_loss: 0.000758
2025-11-07 19:06:53,449 - INFO - New best model found at epoch 574 with val_loss: 0.000710
2025-11-07 19:07:19,639 - INFO - New best model found at epoch 588 with val_loss: 0.000702
2025-11-07 19:07:42,102 - INFO - Epoch [600/1000], Train Loss: 0.001530, Val Loss: 0.001079, LR: 0.000416
2025-11-07 19:09:06,378 - INFO - New best model found at epoch 645 with val_loss: 0.000679
2025-11-07 19:09:15,728 - INFO - Epoch [650/1000], Train Loss: 0.001389, Val Loss: 0.001161, LR: 0.000331
2025-11-07 19:09:47,523 - INFO - New best model found at epoch 667 with val_loss: 0.000674
2025-11-07 19:10:09,952 - INFO - New best model found at epoch 679 with val_loss: 0.000656
2025-11-07 19:10:11,829 - INFO - New best model found at epoch 680 with val_loss: 0.000618
2025-11-07 19:10:32,384 - INFO - New best model found at epoch 691 with val_loss: 0.000581
2025-11-07 19:10:43,590 - INFO - New best model found at epoch 697 with val_loss: 0.000560
2025-11-07 19:10:49,191 - INFO - Epoch [700/1000], Train Loss: 0.001296, Val Loss: 0.000515, LR: 0.000253
2025-11-07 19:10:49,193 - INFO - New best model found at epoch 700 with val_loss: 0.000515
2025-11-07 19:12:15,288 - INFO - New best model found at epoch 746 with val_loss: 0.000481
2025-11-07 19:12:22,754 - INFO - Epoch [750/1000], Train Loss: 0.001159, Val Loss: 0.001048, LR: 0.000182
2025-11-07 19:13:16,963 - INFO - New best model found at epoch 779 with val_loss: 0.000445
2025-11-07 19:13:56,242 - INFO - Epoch [800/1000], Train Loss: 0.001020, Val Loss: 0.000551, LR: 0.000121
2025-11-07 19:15:12,978 - INFO - New best model found at epoch 841 with val_loss: 0.000385
2025-11-07 19:15:29,823 - INFO - Epoch [850/1000], Train Loss: 0.000941, Val Loss: 0.000447, LR: 0.000071
2025-11-07 19:17:03,487 - INFO - Epoch [900/1000], Train Loss: 0.000938, Val Loss: 0.000476, LR: 0.000034
2025-11-07 19:18:20,274 - INFO - Early stopping at epoch 941.
2025-11-07 19:18:20,274 - INFO - Training complete. Evaluating on test set...
2025-11-07 19:18:20,588 - INFO - Final Test Loss (L1): 0.000389
2025-11-07 19:18:20,588 - INFO - Inverting transforms and generating plots...
2025-11-07 19:18:20,592 - INFO - Calculating final metrics...
2025-11-07 19:18:20,611 - INFO - Overall Test MAE (unscaled): 26.118652
2025-11-07 19:18:20,611 - INFO - Overall Test RMSE (unscaled): 80.827431
2025-11-07 19:18:20,611 - INFO - Overall Test R2 (unscaled): 0.999965
2025-11-07 19:18:20,611 - INFO - Overall Test MEDAE (unscaled): 2.156182
2025-11-07 19:18:20,612 - INFO - Overall Test MSE (unscaled): 19000.699219
2025-11-07 19:18:20,612 - INFO - Overall Test EXPLAINED_VARIANCE (unscaled): 0.999966
2025-11-07 19:18:20,612 - INFO - Overall Test MAX_ERROR (unscaled): 5294.156250
2025-11-07 19:18:20,612 - INFO - Overall Test MAPE (unscaled): 0.003599
2025-11-07 19:18:20,612 - INFO - Overall Test REL_ERR_STD (unscaled): 0.017370
2025-11-07 19:18:20,612 - INFO - Overall Test REL_ERR_MEAN_ABS (unscaled): 0.003599
2025-11-07 19:18:20,612 - INFO - Overall Test RESIDUAL_MEAN (unscaled): -16.010513
2025-11-07 19:18:20,612 - INFO - Overall Test RESIDUAL_STD (unscaled): 136.911987
2025-11-07 19:18:20,614 - INFO - Overall Test RESIDUAL_SKEW (unscaled): -8.415087
2025-11-07 19:18:20,615 - INFO - Overall Test RESIDUAL_KURTOSIS (unscaled): 196.672302
2025-11-07 19:18:20,616 - INFO - Overall Test RESIDUAL_P95 (unscaled): 8.347708
2025-11-07 19:18:20,617 - INFO - Overall Test RESIDUAL_P99 (unscaled): 131.159500
2025-11-07 19:18:20,618 - INFO - 
Calculating metrics for feature: Area
2025-11-07 19:18:20,626 - INFO -   Area - MAE: 77.095169
2025-11-07 19:18:20,626 - INFO -   Area - RMSE: 238.727249
2025-11-07 19:18:20,627 - INFO -   Area - R2: 0.999968
2025-11-07 19:18:20,627 - INFO -   Area - MEDAE: 6.114746
2025-11-07 19:18:20,627 - INFO -   Area - MSE: 56990.703125
2025-11-07 19:18:20,627 - INFO -   Area - EXPLAINED_VARIANCE: 0.999969
2025-11-07 19:18:20,627 - INFO -   Area - MAX_ERROR: 5294.156250
2025-11-07 19:18:20,627 - INFO -   Area - MAPE: 0.004542
2025-11-07 19:18:20,628 - INFO -   Area - REL_ERR_STD: 0.028587
2025-11-07 19:18:20,629 - INFO -   Area - REL_ERR_MEAN_ABS: 0.004542
2025-11-07 19:18:20,630 - INFO -   Area - RESIDUAL_MEAN: -47.459412
2025-11-07 19:18:20,631 - INFO -   Area - RESIDUAL_STD: 233.962189
2025-11-07 19:18:20,632 - INFO -   Area - RESIDUAL_SKEW: -4.653981
2025-11-07 19:18:20,633 - INFO -   Area - RESIDUAL_KURTOSIS: 64.634972
2025-11-07 19:18:20,634 - INFO -   Area - RESIDUAL_P95: 73.866577
2025-11-07 19:18:20,634 - INFO -   Area - RESIDUAL_P99: 301.616150
2025-11-07 19:18:20,635 - INFO - 
Calculating metrics for feature: Iso_distance
2025-11-07 19:18:20,645 - INFO -   Iso_distance - MAE: 1.184179
2025-11-07 19:18:20,645 - INFO -   Iso_distance - RMSE: 3.598550
2025-11-07 19:18:20,645 - INFO -   Iso_distance - R2: 0.999944
2025-11-07 19:18:20,645 - INFO -   Iso_distance - MEDAE: 0.323509
2025-11-07 19:18:20,645 - INFO -   Iso_distance - MSE: 12.949560
2025-11-07 19:18:20,645 - INFO -   Iso_distance - EXPLAINED_VARIANCE: 0.999945
2025-11-07 19:18:20,645 - INFO -   Iso_distance - MAX_ERROR: 67.717041
2025-11-07 19:18:20,645 - INFO -   Iso_distance - MAPE: 0.004338
2025-11-07 19:18:20,646 - INFO -   Iso_distance - REL_ERR_STD: 0.007855
2025-11-07 19:18:20,647 - INFO -   Iso_distance - REL_ERR_MEAN_ABS: 0.004338
2025-11-07 19:18:20,648 - INFO -   Iso_distance - RESIDUAL_MEAN: -0.523338
2025-11-07 19:18:20,648 - INFO -   Iso_distance - RESIDUAL_STD: 3.560292
2025-11-07 19:18:20,649 - INFO -   Iso_distance - RESIDUAL_SKEW: -4.443648
2025-11-07 19:18:20,650 - INFO -   Iso_distance - RESIDUAL_KURTOSIS: 105.037956
2025-11-07 19:18:20,651 - INFO -   Iso_distance - RESIDUAL_P95: 1.265142
2025-11-07 19:18:20,652 - INFO -   Iso_distance - RESIDUAL_P99: 3.372597
2025-11-07 19:18:20,653 - INFO - 
Calculating metrics for feature: Iso_width
2025-11-07 19:18:20,662 - INFO -   Iso_width - MAE: 0.076787
2025-11-07 19:18:20,662 - INFO -   Iso_width - RMSE: 0.159857
2025-11-07 19:18:20,662 - INFO -   Iso_width - R2: 0.999983
2025-11-07 19:18:20,662 - INFO -   Iso_width - MEDAE: 0.030290
2025-11-07 19:18:20,662 - INFO -   Iso_width - MSE: 0.025554
2025-11-07 19:18:20,662 - INFO -   Iso_width - EXPLAINED_VARIANCE: 0.999985
2025-11-07 19:18:20,663 - INFO -   Iso_width - MAX_ERROR: 2.498322
2025-11-07 19:18:20,663 - INFO -   Iso_width - MAPE: 0.001917
2025-11-07 19:18:20,663 - INFO -   Iso_width - REL_ERR_STD: 0.004999
2025-11-07 19:18:20,664 - INFO -   Iso_width - REL_ERR_MEAN_ABS: 0.001917
2025-11-07 19:18:20,665 - INFO -   Iso_width - RESIDUAL_MEAN: -0.048795
2025-11-07 19:18:20,666 - INFO -   Iso_width - RESIDUAL_STD: 0.152228
2025-11-07 19:18:20,667 - INFO -   Iso_width - RESIDUAL_SKEW: -4.211461
2025-11-07 19:18:20,668 - INFO -   Iso_width - RESIDUAL_KURTOSIS: 30.678230
2025-11-07 19:18:20,669 - INFO -   Iso_width - RESIDUAL_P95: 0.062435
2025-11-07 19:18:20,670 - INFO -   Iso_width - RESIDUAL_P99: 0.142275
2025-11-07 19:18:20,671 - INFO - Generating plots and logging to TensorBoard...
2025-11-07 19:18:24,131 - INFO - Main training function finished.
2025-11-07 19:18:24,137 - INFO - Final model saved to runs/run_20251107-184746_Area_Iso_distance_Iso_width/final_model/best_model.pt
2025-11-07 19:18:24,138 - INFO - Model configuration saved to runs/run_20251107-184746_Area_Iso_distance_Iso_width/final_model/model_config.json
2025-11-07 19:18:24,138 - INFO - --- Run complete ---
2025-11-07 19:18:24,138 - INFO - To view Optuna results: optuna-dashboard sqlite:///runs/optuna_study.db
2025-11-07 19:18:24,139 - INFO - To view TensorBoard logs: tensorboard --logdir runs/run_20251107-184746_Area_Iso_distance_Iso_width/
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
NeuralNetwork                            [64, 3]                   --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-1                       [64, 152]                 1,520
│    └─GELU: 2-2                         [64, 152]                 --
├─Dropout: 1-2                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-3                       [64, 152]                 23,256
│    └─GELU: 2-4                         [64, 152]                 --
├─Dropout: 1-4                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-5                       [64, 152]                 23,256
│    └─GELU: 2-6                         [64, 152]                 --
├─Dropout: 1-6                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-7                       [64, 152]                 23,256
│    └─GELU: 2-8                         [64, 152]                 --
├─Dropout: 1-8                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-9                       [64, 3]                   459
==========================================================================================
Total params: 71,747
Trainable params: 71,747
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 4.59
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.31
Params size (MB): 0.29
Estimated Total Size (MB): 0.60
==========================================================================================
Job finished with exit code: 0
