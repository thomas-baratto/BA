Job started on argon-gtx
Job ID: 519
Working directory: /home/barattts/lavoltabuona/BA
---
Starting Python script...
Running: python run_optuna.py --target Area --skip-optuna
2025-11-06 13:38:16,353 - INFO - Using device: cuda
2025-11-06 13:38:16,354 - INFO - Target labels for this run: ['Area']
2025-11-06 13:38:16,354 - INFO - Skip Optuna: True
2025-11-06 13:38:16,355 - INFO - Skipping Optuna. Loading best parameters from study: nn_study_['Area']...
2025-11-06 13:38:17,407 - INFO - Loaded best parameters from trial 333:
2025-11-06 13:38:17,433 - INFO - Best value (RMSE): 0.0009757127058634517
2025-11-06 13:38:17,433 - INFO - Parameters: {'batch_size': 64, 'learning_rate': 0.001372335074817238, 'nr_hidden_layers': 2, 'nr_neurons': 230, 'dropout_rate': 8.943741579532514e-05, 'weight_decay': 0.00021732207759797098, 'activation_name': 'GELU', 'loss_criterion': 'MSE'}
2025-11-06 13:38:17,433 - INFO - Training final model with parameters...
2025-11-06 13:38:17,433 - INFO - Starting main training for labels ['Area']...
2025-11-06 13:38:18,549 - INFO - Final training: 47896 train samples, 11975 val samples, 25660 test samples.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:734: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
2025-11-06 13:38:18,943 - INFO - Using MSELoss
2025-11-06 13:38:22,208 - INFO - Using CosineAnnealingLR with T_max=1000
2025-11-06 13:38:22,349 - INFO - Starting final training loop for max 1000 epochs (Patience=25)...
2025-11-06 13:38:24,566 - INFO - Epoch [1/1000], Train Loss: 0.010906, Val Loss: 0.007929, LR: 0.001372
2025-11-06 13:38:24,569 - INFO - New best model found at epoch 1 with val_loss: 0.007929
2025-11-06 13:38:26,565 - INFO - New best model found at epoch 2 with val_loss: 0.003981
2025-11-06 13:38:28,557 - INFO - New best model found at epoch 3 with val_loss: 0.002174
2025-11-06 13:38:30,561 - INFO - New best model found at epoch 4 with val_loss: 0.001533
2025-11-06 13:38:34,531 - INFO - New best model found at epoch 6 with val_loss: 0.000619
2025-11-06 13:38:38,493 - INFO - New best model found at epoch 8 with val_loss: 0.000299
2025-11-06 13:38:43,132 - INFO - New best model found at epoch 10 with val_loss: 0.000181
2025-11-06 13:38:45,127 - INFO - New best model found at epoch 11 with val_loss: 0.000151
2025-11-06 13:38:49,097 - INFO - New best model found at epoch 13 with val_loss: 0.000137
2025-11-06 13:38:59,019 - INFO - New best model found at epoch 18 with val_loss: 0.000132
2025-11-06 13:39:02,998 - INFO - New best model found at epoch 20 with val_loss: 0.000087
2025-11-06 13:39:10,931 - INFO - New best model found at epoch 24 with val_loss: 0.000086
2025-11-06 13:39:12,917 - INFO - New best model found at epoch 25 with val_loss: 0.000053
2025-11-06 13:39:20,845 - INFO - New best model found at epoch 29 with val_loss: 0.000052
2025-11-06 13:39:24,811 - INFO - New best model found at epoch 31 with val_loss: 0.000046
2025-11-06 13:39:26,790 - INFO - New best model found at epoch 32 with val_loss: 0.000030
2025-11-06 13:39:36,863 - INFO - New best model found at epoch 37 with val_loss: 0.000024
2025-11-06 13:39:53,427 - INFO - New best model found at epoch 45 with val_loss: 0.000024
2025-11-06 13:40:03,753 - INFO - Epoch [50/1000], Train Loss: 0.000088, Val Loss: 0.000042, LR: 0.001364
2025-11-06 13:40:05,751 - INFO - New best model found at epoch 51 with val_loss: 0.000018
2025-11-06 13:40:27,844 - INFO - New best model found at epoch 61 with val_loss: 0.000018
2025-11-06 13:40:44,724 - INFO - New best model found at epoch 69 with val_loss: 0.000016
2025-11-06 13:40:54,524 - INFO - New best model found at epoch 74 with val_loss: 0.000011
2025-11-06 13:41:05,635 - INFO - New best model found at epoch 81 with val_loss: 0.000010
2025-11-06 13:41:30,030 - INFO - New best model found at epoch 96 with val_loss: 0.000009
2025-11-06 13:41:33,275 - INFO - New best model found at epoch 98 with val_loss: 0.000007
2025-11-06 13:41:36,510 - INFO - Epoch [100/1000], Train Loss: 0.000037, Val Loss: 0.000011, LR: 0.001339
2025-11-06 13:41:52,549 - INFO - New best model found at epoch 110 with val_loss: 0.000007
2025-11-06 13:42:05,308 - INFO - New best model found at epoch 118 with val_loss: 0.000005
2025-11-06 13:42:16,556 - INFO - New best model found at epoch 125 with val_loss: 0.000005
2025-11-06 13:42:26,159 - INFO - New best model found at epoch 131 with val_loss: 0.000005
2025-11-06 13:42:51,695 - INFO - New best model found at epoch 147 with val_loss: 0.000003
2025-11-06 13:42:56,485 - INFO - Epoch [150/1000], Train Loss: 0.000020, Val Loss: 0.000029, LR: 0.001298
2025-11-06 13:43:31,849 - INFO - Early stopping at epoch 172.
2025-11-06 13:43:31,849 - INFO - Training complete. Evaluating on test set...
2025-11-06 13:43:32,161 - INFO - Final Test Loss (MSE): 0.000003
2025-11-06 13:43:32,161 - INFO - Inverting transforms and generating plots...
2025-11-06 13:43:32,166 - INFO - Calculating final metrics...
2025-11-06 13:43:32,174 - INFO - Final Test MAE (unscaled): 274.329041
2025-11-06 13:43:32,174 - INFO - Final Test RMSE (unscaled): 849.416870
2025-11-06 13:43:32,174 - INFO - Final Test R2 (unscaled): 0.999598
2025-11-06 13:43:32,174 - INFO - Final Test MEDAE (unscaled): 34.831055
2025-11-06 13:43:32,174 - INFO - Final Test MAPE (unscaled): 0.017662
2025-11-06 13:43:32,174 - INFO - Final Test REL_ERR_STD (unscaled): 0.030763
2025-11-06 13:43:32,175 - INFO - Final Test REL_ERR_MEAN_ABS (unscaled): 0.017662
2025-11-06 13:43:33,284 - INFO - Logging scatter plots to tensorboard...
2025-11-06 13:43:33,432 - INFO - Main training function finished.
2025-11-06 13:43:33,438 - INFO - Final model saved to runs/run_20251106-133816_['Area']/final_model/best_model.pt
2025-11-06 13:43:33,438 - INFO - --- Run complete ---
2025-11-06 13:43:33,438 - INFO - To view Optuna results: optuna-dashboard sqlite:///runs/optuna_study.db
2025-11-06 13:43:33,438 - INFO - To view TensorBoard logs: tensorboard --logdir runs/run_20251106-133816_['Area']/
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
NeuralNetwork                            [64, 1]                   --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-1                       [64, 230]                 2,300
│    └─GELU: 2-2                         [64, 230]                 --
├─Dropout: 1-2                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-3                       [64, 230]                 53,130
│    └─GELU: 2-4                         [64, 230]                 --
├─Dropout: 1-4                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-5                       [64, 230]                 53,130
│    └─GELU: 2-6                         [64, 230]                 --
├─Dropout: 1-6                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-7                       [64, 1]                   231
==========================================================================================
Total params: 108,791
Trainable params: 108,791
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 6.96
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.35
Params size (MB): 0.44
Estimated Total Size (MB): 0.79
==========================================================================================
Job finished.
