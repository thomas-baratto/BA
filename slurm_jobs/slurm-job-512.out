Job started on argon-gtx
Job ID: 512
Working directory: /home/barattts/lavoltabuona/BA
---
Starting Python script...
Running: python run_optuna.py --target Area
2025-11-06 13:01:45,009 - INFO - Using device: cuda
2025-11-06 13:01:45,010 - INFO - Target labels for this run: ['Area']
2025-11-06 13:01:45,011 - INFO - Loading data for Optuna study (Labels: ['Area'])...
2025-11-06 13:01:45,191 - INFO - Starting Optuna study: nn_study_['Area']...
[I 2025-11-06 13:01:46,193] Using an existing study with name 'nn_study_['Area']' instead of creating a new one.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:734: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
[I 2025-11-06 13:02:17,631] Trial 2000 pruned. 
2025-11-06 13:02:17,726 - INFO - Optuna study complete. Best trial: 333
2025-11-06 13:02:17,817 - INFO - Best Loss: 0.0009757127058634517
2025-11-06 13:02:17,842 - INFO - Best Params: {'batch_size': 64, 'learning_rate': 0.001372335074817238, 'nr_hidden_layers': 2, 'nr_neurons': 230, 'dropout_rate': 8.943741579532514e-05, 'weight_decay': 0.00021732207759797098, 'activation_name': 'GELU', 'loss_criterion': 'MSE'}
2025-11-06 13:02:17,842 - INFO - Training final model with best parameters...
2025-11-06 13:02:17,869 - INFO - Starting main training for labels ['Area']...
2025-11-06 13:02:18,976 - INFO - Final training: 47896 train samples, 11975 val samples, 25660 test samples.
2025-11-06 13:02:19,008 - INFO - Using MSELoss
2025-11-06 13:02:19,008 - INFO - Using CosineAnnealingLR with T_max=1000
2025-11-06 13:02:19,021 - INFO - Starting final training loop for max 1000 epochs (Patience=100)...
2025-11-06 13:02:21,010 - INFO - Epoch [1/1000], Train Loss: 0.010679, Val Loss: 0.006885, LR: 0.001372
2025-11-06 13:02:21,014 - INFO - New best model found at epoch 1 with val_loss: 0.006885
2025-11-06 13:02:25,108 - INFO - New best model found at epoch 2 with val_loss: 0.003594
2025-11-06 13:02:29,133 - INFO - New best model found at epoch 3 with val_loss: 0.002098
2025-11-06 13:02:31,122 - INFO - New best model found at epoch 4 with val_loss: 0.001455
2025-11-06 13:02:33,116 - INFO - New best model found at epoch 5 with val_loss: 0.001201
2025-11-06 13:02:35,097 - INFO - New best model found at epoch 6 with val_loss: 0.000890
2025-11-06 13:02:37,099 - INFO - New best model found at epoch 7 with val_loss: 0.000563
2025-11-06 13:02:39,079 - INFO - New best model found at epoch 8 with val_loss: 0.000385
2025-11-06 13:02:41,049 - INFO - New best model found at epoch 9 with val_loss: 0.000338
2025-11-06 13:02:43,027 - INFO - New best model found at epoch 10 with val_loss: 0.000255
2025-11-06 13:02:46,971 - INFO - New best model found at epoch 12 with val_loss: 0.000209
2025-11-06 13:02:50,882 - INFO - New best model found at epoch 14 with val_loss: 0.000153
2025-11-06 13:03:00,758 - INFO - New best model found at epoch 18 with val_loss: 0.000125
2025-11-06 13:03:08,585 - INFO - New best model found at epoch 22 with val_loss: 0.000101
2025-11-06 13:03:10,546 - INFO - New best model found at epoch 23 with val_loss: 0.000049
2025-11-06 13:03:43,799 - INFO - New best model found at epoch 40 with val_loss: 0.000032
2025-11-06 13:03:57,511 - INFO - New best model found at epoch 47 with val_loss: 0.000024
2025-11-06 13:04:03,391 - INFO - Epoch [50/1000], Train Loss: 0.000057, Val Loss: 0.000032, LR: 0.001364
2025-11-06 13:04:19,049 - INFO - New best model found at epoch 58 with val_loss: 0.000020
2025-11-06 13:04:42,538 - INFO - New best model found at epoch 70 with val_loss: 0.000013
2025-11-06 13:05:08,004 - INFO - New best model found at epoch 83 with val_loss: 0.000009
2025-11-06 13:05:39,351 - INFO - New best model found at epoch 99 with val_loss: 0.000006
2025-11-06 13:05:41,307 - INFO - Epoch [100/1000], Train Loss: 0.000033, Val Loss: 0.000015, LR: 0.001339
2025-11-06 13:07:06,686 - INFO - New best model found at epoch 141 with val_loss: 0.000004
2025-11-06 13:07:24,289 - INFO - Epoch [150/1000], Train Loss: 0.000020, Val Loss: 0.000007, LR: 0.001298
2025-11-06 13:08:03,398 - INFO - New best model found at epoch 170 with val_loss: 0.000004
2025-11-06 13:08:22,925 - INFO - New best model found at epoch 180 with val_loss: 0.000004
2025-11-06 13:08:50,293 - INFO - New best model found at epoch 194 with val_loss: 0.000004
2025-11-06 13:09:02,052 - INFO - Epoch [200/1000], Train Loss: 0.000017, Val Loss: 0.000016, LR: 0.001241
2025-11-06 13:09:31,912 - INFO - New best model found at epoch 212 with val_loss: 0.000003
2025-11-06 13:10:11,298 - INFO - New best model found at epoch 231 with val_loss: 0.000003
2025-11-06 13:10:30,847 - INFO - New best model found at epoch 241 with val_loss: 0.000003
2025-11-06 13:10:48,459 - INFO - Epoch [250/1000], Train Loss: 0.000011, Val Loss: 0.000023, LR: 0.001171
2025-11-06 13:11:13,933 - INFO - New best model found at epoch 263 with val_loss: 0.000002
2025-11-06 13:12:26,967 - INFO - Epoch [300/1000], Train Loss: 0.000008, Val Loss: 0.000004, LR: 0.001089
2025-11-06 13:12:46,636 - INFO - New best model found at epoch 310 with val_loss: 0.000002
2025-11-06 13:14:04,967 - INFO - Epoch [350/1000], Train Loss: 0.000008, Val Loss: 0.000014, LR: 0.000998
2025-11-06 13:14:24,544 - INFO - New best model found at epoch 360 with val_loss: 0.000002
2025-11-06 13:15:42,880 - INFO - Epoch [400/1000], Train Loss: 0.000006, Val Loss: 0.000002, LR: 0.000898
2025-11-06 13:16:06,385 - INFO - New best model found at epoch 412 with val_loss: 0.000001
2025-11-06 13:16:55,896 - INFO - New best model found at epoch 436 with val_loss: 0.000001
2025-11-06 13:17:23,318 - INFO - Epoch [450/1000], Train Loss: 0.000015, Val Loss: 0.000002, LR: 0.000794
2025-11-06 13:19:01,495 - INFO - Epoch [500/1000], Train Loss: 0.000005, Val Loss: 0.000009, LR: 0.000686
2025-11-06 13:20:11,994 - INFO - Early stopping at epoch 536.
2025-11-06 13:20:11,995 - INFO - Training complete. Evaluating on test set...
2025-11-06 13:20:12,412 - INFO - Final Test Loss (MSE): 0.000001
2025-11-06 13:20:12,412 - INFO - Inverting transforms and generating plots...
2025-11-06 13:20:12,414 - INFO - Calculating final metrics...
2025-11-06 13:20:12,419 - INFO - Final Test MAE: 164.231003
2025-11-06 13:20:12,419 - INFO - Final Test RMSE: 548.728149
2025-11-06 13:20:12,419 - INFO - Final Test R2: 0.999832
2025-11-06 13:20:12,419 - INFO - Final Test MEDAE: 15.892273
2025-11-06 13:20:12,419 - INFO - Final Test MAPE: 0.009036
2025-11-06 13:20:12,420 - INFO - Final Test REL_ERR_STD: 0.021501
2025-11-06 13:20:12,420 - INFO - Final Test REL_ERR_MEAN_ABS: 0.009036
2025-11-06 13:20:13,133 - INFO - Logging plots to tensorboard...
2025-11-06 13:20:13,281 - INFO - Main training function finished.
2025-11-06 13:20:13,288 - INFO - Final model saved to runs/run_20251106-130145_['Area']/final_model/best_model.pt
2025-11-06 13:20:13,288 - INFO - --- Run complete ---
2025-11-06 13:20:13,289 - INFO - To view Optuna results: optuna-dashboard sqlite:///runs/optuna_study.db
2025-11-06 13:20:13,289 - INFO - To view TensorBoard logs: tensorboard --logdir runs/run_20251106-130145_['Area']/
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
NeuralNetwork                            [64, 1]                   --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-1                       [64, 230]                 2,300
│    └─GELU: 2-2                         [64, 230]                 --
├─Dropout: 1-2                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-3                       [64, 230]                 53,130
│    └─GELU: 2-4                         [64, 230]                 --
├─Dropout: 1-4                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-5                       [64, 230]                 53,130
│    └─GELU: 2-6                         [64, 230]                 --
├─Dropout: 1-6                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-7                       [64, 1]                   231
==========================================================================================
Total params: 108,791
Trainable params: 108,791
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 6.96
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.35
Params size (MB): 0.44
Estimated Total Size (MB): 0.79
==========================================================================================
Job finished.
