Job started on argon-gtx
Job ID: 548
Working directory: /home/barattts/lavoltabuona/BA
---
Starting Python script...
Unable to determine the device handle for GPU0000:61:00.0: Unknown Error
Running: python run_optuna.py --target all --skip-optuna
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-07 18:40:44,340 - INFO - Using device: cpu
2025-11-07 18:40:44,341 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-07 18:40:44,341 - INFO - Skip Optuna: True
2025-11-07 18:40:44,342 - INFO - Skipping Optuna. Loading best parameters from study: nn_study_Area_Iso_distance_Iso_width...
2025-11-07 18:40:45,340 - INFO - Successfully loaded best parameters from trial 587:
2025-11-07 18:40:45,363 - INFO -   Best value (RMSE): 0.000741
2025-11-07 18:40:52,208 - INFO -   Number of trials completed: 2986
2025-11-07 18:40:52,208 - INFO -   Optimized parameters:
2025-11-07 18:40:52,325 - INFO -     batch_size: 64
2025-11-07 18:40:52,325 - INFO -     learning_rate: 0.0011537697650495493
2025-11-07 18:40:52,325 - INFO -     nr_hidden_layers: 3
2025-11-07 18:40:52,325 - INFO -     nr_neurons: 152
2025-11-07 18:40:52,325 - INFO -     dropout_rate: 0.0007055009826885291
2025-11-07 18:40:52,325 - INFO -     weight_decay: 1.3078059031292613e-05
2025-11-07 18:40:52,325 - INFO -     activation_name: GELU
2025-11-07 18:40:52,325 - INFO -     loss_criterion: L1
2025-11-07 18:40:52,325 - INFO -   Hardcoded parameters:
2025-11-07 18:40:52,325 - INFO -     batch_size: 64
2025-11-07 18:40:52,325 - INFO -     nr_hidden_layers: 3
2025-11-07 18:40:52,325 - INFO -     activation_name: GELU
2025-11-07 18:40:52,325 - INFO -     loss_criterion: L1
2025-11-07 18:40:52,325 - INFO - Training final model with parameters...
2025-11-07 18:40:52,325 - INFO - Starting main training for labels ['Area', 'Iso_distance', 'Iso_width']...
2025-11-07 18:40:54,904 - INFO - Final training: 47896 train samples, 11975 val samples, 25660 test samples.
2025-11-07 18:40:54,959 - INFO - Using L1Loss (MAE)
2025-11-07 18:40:56,845 - INFO - Using CosineAnnealingLR with T_max=1000
2025-11-07 18:40:56,845 - INFO - Added warmup for 10 epochs
2025-11-07 18:40:56,880 - INFO - Starting final training loop for max 1000 epochs (Patience=100)...
2025-11-07 18:41:00,549 - INFO - Epoch [1/1000], Train Loss: 0.130568, Val Loss: 0.068706, LR: 0.000219
2025-11-07 18:41:00,551 - INFO - New best model found at epoch 1 with val_loss: 0.068706
2025-11-07 18:41:04,186 - INFO - New best model found at epoch 2 with val_loss: 0.066023
2025-11-07 18:41:07,777 - INFO - New best model found at epoch 3 with val_loss: 0.064703
2025-11-07 18:41:11,380 - INFO - New best model found at epoch 4 with val_loss: 0.060670
2025-11-07 18:41:14,972 - INFO - New best model found at epoch 5 with val_loss: 0.051524
2025-11-07 18:41:18,596 - INFO - New best model found at epoch 6 with val_loss: 0.047195
2025-11-07 18:41:22,228 - INFO - New best model found at epoch 7 with val_loss: 0.036041
2025-11-07 18:41:25,872 - INFO - New best model found at epoch 8 with val_loss: 0.035962
2025-11-07 18:41:29,473 - INFO - New best model found at epoch 9 with val_loss: 0.030980
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:243: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-11-07 18:41:33,034 - INFO - New best model found at epoch 10 with val_loss: 0.020862
2025-11-07 18:41:40,152 - INFO - New best model found at epoch 12 with val_loss: 0.018971
2025-11-07 18:41:47,414 - INFO - New best model found at epoch 14 with val_loss: 0.016247
2025-11-07 18:41:51,039 - INFO - New best model found at epoch 15 with val_loss: 0.014299
2025-11-07 18:41:54,548 - INFO - New best model found at epoch 16 with val_loss: 0.013299
slurmstepd-argon-gtx: error: *** JOB 548 ON argon-gtx CANCELLED AT 2025-11-07T18:41:55 ***
