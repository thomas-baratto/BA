Job started on argon-gtx
Job ID: 522
Working directory: /home/barattts/lavoltabuona/BA
---
Starting Python script...
Running: python run_optuna.py --target all --skip-optuna
2025-11-06 13:41:24,560 - INFO - Using device: cuda
2025-11-06 13:41:24,561 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-06 13:41:24,561 - INFO - Skip Optuna: True
2025-11-06 13:41:24,562 - INFO - Skipping Optuna. Loading best parameters from study: nn_study_['Area', 'Iso_distance', 'Iso_width']...
2025-11-06 13:41:25,471 - INFO - Loaded best parameters from trial 587:
2025-11-06 13:41:25,494 - INFO - Best value (RMSE): 0.0007413936528887068
2025-11-06 13:41:25,494 - INFO - Parameters: {'batch_size': 64, 'learning_rate': 0.0011537697650495493, 'nr_hidden_layers': 3, 'nr_neurons': 152, 'dropout_rate': 0.0007055009826885291, 'weight_decay': 1.3078059031292613e-05, 'activation_name': 'GELU', 'loss_criterion': 'L1'}
2025-11-06 13:41:25,494 - INFO - Training final model with parameters...
2025-11-06 13:41:25,494 - INFO - Starting main training for labels ['Area', 'Iso_distance', 'Iso_width']...
2025-11-06 13:41:27,865 - INFO - Final training: 47896 train samples, 11975 val samples, 25660 test samples.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:734: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
2025-11-06 13:41:28,219 - INFO - Using L1Loss (MAE)
2025-11-06 13:41:30,428 - INFO - Using CosineAnnealingLR with T_max=1000
2025-11-06 13:41:30,483 - INFO - Starting final training loop for max 1000 epochs (Patience=25)...
2025-11-06 13:41:32,433 - INFO - Epoch [1/1000], Train Loss: 0.079093, Val Loss: 0.064983, LR: 0.001154
2025-11-06 13:41:32,435 - INFO - New best model found at epoch 1 with val_loss: 0.064983
2025-11-06 13:41:34,199 - INFO - New best model found at epoch 2 with val_loss: 0.056303
2025-11-06 13:41:35,980 - INFO - New best model found at epoch 3 with val_loss: 0.043429
2025-11-06 13:41:37,749 - INFO - New best model found at epoch 4 with val_loss: 0.033516
2025-11-06 13:41:39,516 - INFO - New best model found at epoch 5 with val_loss: 0.030436
2025-11-06 13:41:41,263 - INFO - New best model found at epoch 6 with val_loss: 0.024694
2025-11-06 13:41:43,011 - INFO - New best model found at epoch 7 with val_loss: 0.020428
2025-11-06 13:41:44,760 - INFO - New best model found at epoch 8 with val_loss: 0.016621
2025-11-06 13:41:46,518 - INFO - New best model found at epoch 9 with val_loss: 0.016544
2025-11-06 13:41:48,274 - INFO - New best model found at epoch 10 with val_loss: 0.010217
2025-11-06 13:41:55,258 - INFO - New best model found at epoch 14 with val_loss: 0.009151
2025-11-06 13:42:00,496 - INFO - New best model found at epoch 17 with val_loss: 0.009066
2025-11-06 13:42:02,245 - INFO - New best model found at epoch 18 with val_loss: 0.007688
2025-11-06 13:42:05,196 - INFO - New best model found at epoch 19 with val_loss: 0.007324
2025-11-06 13:42:13,977 - INFO - New best model found at epoch 24 with val_loss: 0.005268
2025-11-06 13:42:20,514 - INFO - New best model found at epoch 27 with val_loss: 0.004620
2025-11-06 13:42:36,222 - INFO - New best model found at epoch 36 with val_loss: 0.004538
2025-11-06 13:42:43,217 - INFO - New best model found at epoch 40 with val_loss: 0.004285
2025-11-06 13:42:44,980 - INFO - New best model found at epoch 41 with val_loss: 0.002687
2025-11-06 13:43:00,753 - INFO - Epoch [50/1000], Train Loss: 0.005155, Val Loss: 0.004049, LR: 0.001147
2025-11-06 13:43:28,547 - INFO - Early stopping at epoch 66.
2025-11-06 13:43:28,547 - INFO - Training complete. Evaluating on test set...
2025-11-06 13:43:28,876 - INFO - Final Test Loss (L1): 0.002708
2025-11-06 13:43:28,876 - INFO - Inverting transforms and generating plots...
2025-11-06 13:43:28,880 - INFO - Calculating final metrics...
2025-11-06 13:43:28,890 - INFO - Final Test MAE (unscaled): 231.991089
2025-11-06 13:43:28,890 - INFO - Final Test RMSE (unscaled): 748.682190
2025-11-06 13:43:28,891 - INFO - Final Test R2 (unscaled): 0.998157
2025-11-06 13:43:28,891 - INFO - Final Test MEDAE (unscaled): 18.594984
2025-11-06 13:43:28,891 - INFO - Final Test MAPE (unscaled): 0.025861
2025-11-06 13:43:28,891 - INFO - Final Test REL_ERR_STD (unscaled): 0.108970
2025-11-06 13:43:28,891 - INFO - Final Test REL_ERR_MEAN_ABS (unscaled): 0.025861
2025-11-06 13:43:30,359 - INFO - Logging scatter plots to tensorboard...
2025-11-06 13:43:30,784 - INFO - Main training function finished.
2025-11-06 13:43:30,789 - INFO - Final model saved to runs/run_20251106-134124_['Area', 'Iso_distance', 'Iso_width']/final_model/best_model.pt
2025-11-06 13:43:30,789 - INFO - --- Run complete ---
2025-11-06 13:43:30,789 - INFO - To view Optuna results: optuna-dashboard sqlite:///runs/optuna_study.db
2025-11-06 13:43:30,789 - INFO - To view TensorBoard logs: tensorboard --logdir runs/run_20251106-134124_['Area', 'Iso_distance', 'Iso_width']/
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
NeuralNetwork                            [64, 3]                   --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-1                       [64, 152]                 1,520
│    └─GELU: 2-2                         [64, 152]                 --
├─Dropout: 1-2                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-3                       [64, 152]                 23,256
│    └─GELU: 2-4                         [64, 152]                 --
├─Dropout: 1-4                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-5                       [64, 152]                 23,256
│    └─GELU: 2-6                         [64, 152]                 --
├─Dropout: 1-6                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-7                       [64, 152]                 23,256
│    └─GELU: 2-8                         [64, 152]                 --
├─Dropout: 1-8                           [64, 152]                 --
├─ModuleList: 1-9                        --                        (recursive)
│    └─Linear: 2-9                       [64, 3]                   459
==========================================================================================
Total params: 71,747
Trainable params: 71,747
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 4.59
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.31
Params size (MB): 0.29
Estimated Total Size (MB): 0.60
==========================================================================================
Job finished.
