Job started on argon-gtx
Job ID: 553
Working directory: /home/barattts/lavoltabuona/BA
---
Starting Python script...
Unable to determine the device handle for GPU0000:61:00.0: Unknown Error
Running: python run_optuna.py --target Area --skip-optuna
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-07 18:47:42,670 - INFO - Using device: cuda
2025-11-07 18:47:42,672 - INFO - Target labels for this run: ['Area']
2025-11-07 18:47:42,672 - INFO - Skip Optuna: True
2025-11-07 18:47:42,673 - INFO - Skipping Optuna. Loading best parameters from study: nn_study_Area...
2025-11-07 18:47:43,773 - INFO - Successfully loaded best parameters from trial 333:
2025-11-07 18:47:43,800 - INFO -   Best value (RMSE): 0.000976
2025-11-07 18:47:49,881 - INFO -   Number of trials completed: 2718
2025-11-07 18:47:49,882 - INFO -   Optimized parameters:
2025-11-07 18:47:49,999 - INFO -     batch_size: 64
2025-11-07 18:47:50,000 - INFO -     learning_rate: 0.001372335074817238
2025-11-07 18:47:50,000 - INFO -     nr_hidden_layers: 2
2025-11-07 18:47:50,000 - INFO -     nr_neurons: 230
2025-11-07 18:47:50,000 - INFO -     dropout_rate: 8.943741579532514e-05
2025-11-07 18:47:50,000 - INFO -     weight_decay: 0.00021732207759797098
2025-11-07 18:47:50,000 - INFO -     activation_name: GELU
2025-11-07 18:47:50,000 - INFO -     loss_criterion: MSE
2025-11-07 18:47:50,000 - INFO - Training final model with parameters...
2025-11-07 18:47:50,000 - INFO - Starting main training for labels ['Area']...
2025-11-07 18:47:51,063 - INFO - Final training: 47896 train samples, 11975 val samples, 25660 test samples.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:734: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
2025-11-07 18:47:51,512 - INFO - Using MSELoss
2025-11-07 18:47:53,791 - INFO - Using CosineAnnealingLR with T_max=1000
2025-11-07 18:47:53,791 - INFO - Added warmup for 10 epochs
2025-11-07 18:47:53,859 - INFO - Starting final training loop for max 1000 epochs (Patience=100)...
2025-11-07 18:47:55,918 - INFO - Epoch [1/1000], Train Loss: 0.025618, Val Loss: 0.008648, LR: 0.000261
2025-11-07 18:47:55,920 - INFO - New best model found at epoch 1 with val_loss: 0.008648
2025-11-07 18:47:57,801 - INFO - New best model found at epoch 2 with val_loss: 0.008092
2025-11-07 18:47:59,670 - INFO - New best model found at epoch 3 with val_loss: 0.007097
2025-11-07 18:48:01,470 - INFO - New best model found at epoch 4 with val_loss: 0.004613
2025-11-07 18:48:03,298 - INFO - New best model found at epoch 5 with val_loss: 0.004216
2025-11-07 18:48:05,113 - INFO - New best model found at epoch 6 with val_loss: 0.002679
2025-11-07 18:48:06,914 - INFO - New best model found at epoch 7 with val_loss: 0.001837
2025-11-07 18:48:10,593 - INFO - New best model found at epoch 9 with val_loss: 0.001397
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/optim/lr_scheduler.py:243: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
2025-11-07 18:48:14,221 - INFO - New best model found at epoch 11 with val_loss: 0.000997
2025-11-07 18:48:16,026 - INFO - New best model found at epoch 12 with val_loss: 0.000767
2025-11-07 18:48:19,639 - INFO - New best model found at epoch 14 with val_loss: 0.000447
2025-11-07 18:48:21,452 - INFO - New best model found at epoch 15 with val_loss: 0.000232
2025-11-07 18:48:25,076 - INFO - New best model found at epoch 17 with val_loss: 0.000156
2025-11-07 18:48:30,448 - INFO - New best model found at epoch 20 with val_loss: 0.000065
2025-11-07 18:48:48,267 - INFO - New best model found at epoch 30 with val_loss: 0.000062
2025-11-07 18:48:50,039 - INFO - New best model found at epoch 31 with val_loss: 0.000058
2025-11-07 18:49:04,336 - INFO - New best model found at epoch 39 with val_loss: 0.000048
2025-11-07 18:49:06,155 - INFO - New best model found at epoch 40 with val_loss: 0.000032
2025-11-07 18:49:22,153 - INFO - New best model found at epoch 49 with val_loss: 0.000026
2025-11-07 18:49:23,942 - INFO - Epoch [50/1000], Train Loss: 0.000070, Val Loss: 0.000026, LR: 0.001367
2025-11-07 18:49:23,943 - INFO - New best model found at epoch 50 with val_loss: 0.000026
2025-11-07 18:49:32,820 - INFO - New best model found at epoch 55 with val_loss: 0.000023
2025-11-07 18:49:39,907 - INFO - New best model found at epoch 59 with val_loss: 0.000021
2025-11-07 18:49:47,061 - INFO - New best model found at epoch 63 with val_loss: 0.000018
2025-11-07 18:50:12,339 - INFO - New best model found at epoch 77 with val_loss: 0.000010
2025-11-07 18:50:53,220 - INFO - Epoch [100/1000], Train Loss: 0.000033, Val Loss: 0.000018, LR: 0.001345
2025-11-07 18:51:07,435 - INFO - New best model found at epoch 108 with val_loss: 0.000007
2025-11-07 18:52:22,162 - INFO - Epoch [150/1000], Train Loss: 0.000023, Val Loss: 0.000006, LR: 0.001307
2025-11-07 18:52:22,164 - INFO - New best model found at epoch 150 with val_loss: 0.000006
2025-11-07 18:53:08,949 - INFO - New best model found at epoch 176 with val_loss: 0.000006
2025-11-07 18:53:30,758 - INFO - New best model found at epoch 188 with val_loss: 0.000006
2025-11-07 18:53:47,248 - INFO - New best model found at epoch 197 with val_loss: 0.000003
2025-11-07 18:53:52,773 - INFO - Epoch [200/1000], Train Loss: 0.000016, Val Loss: 0.000004, LR: 0.001254
2025-11-07 18:54:09,327 - INFO - New best model found at epoch 209 with val_loss: 0.000002
2025-11-07 18:55:23,891 - INFO - Epoch [250/1000], Train Loss: 0.000013, Val Loss: 0.000006, LR: 0.001186
2025-11-07 18:55:45,714 - INFO - New best model found at epoch 262 with val_loss: 0.000002
2025-11-07 18:56:57,020 - INFO - Epoch [300/1000], Train Loss: 0.000011, Val Loss: 0.000017, LR: 0.001107
2025-11-07 18:57:28,028 - INFO - New best model found at epoch 317 with val_loss: 0.000001
2025-11-07 18:58:28,195 - INFO - Epoch [350/1000], Train Loss: 0.000008, Val Loss: 0.000005, LR: 0.001017
2025-11-07 18:59:59,704 - INFO - Epoch [400/1000], Train Loss: 0.000010, Val Loss: 0.000005, LR: 0.000919
2025-11-07 19:00:30,640 - INFO - Early stopping at epoch 417.
2025-11-07 19:00:30,640 - INFO - Training complete. Evaluating on test set...
2025-11-07 19:00:30,957 - INFO - Final Test Loss (MSE): 0.000001
2025-11-07 19:00:30,958 - INFO - Inverting transforms and generating plots...
2025-11-07 19:00:30,960 - INFO - Calculating final metrics...
2025-11-07 19:00:30,969 - INFO - Overall Test MAE (unscaled): 200.495865
2025-11-07 19:00:30,970 - INFO - Overall Test RMSE (unscaled): 690.058411
2025-11-07 19:00:30,970 - INFO - Overall Test R2 (unscaled): 0.999735
2025-11-07 19:00:30,970 - INFO - Overall Test MEDAE (unscaled): 19.289551
2025-11-07 19:00:30,970 - INFO - Overall Test MSE (unscaled): 476180.593750
2025-11-07 19:00:30,970 - INFO - Overall Test EXPLAINED_VARIANCE (unscaled): 0.999738
2025-11-07 19:00:30,970 - INFO - Overall Test MAX_ERROR (unscaled): 16080.531250
2025-11-07 19:00:30,970 - INFO - Overall Test MAPE (unscaled): 0.010480
2025-11-07 19:00:30,970 - INFO - Overall Test REL_ERR_STD (unscaled): 0.024327
2025-11-07 19:00:30,970 - INFO - Overall Test REL_ERR_MEAN_ABS (unscaled): 0.010480
2025-11-07 19:00:30,970 - INFO - Overall Test RESIDUAL_MEAN (unscaled): 70.174149
2025-11-07 19:00:30,971 - INFO - Overall Test RESIDUAL_STD (unscaled): 686.481018
2025-11-07 19:00:30,971 - INFO - Overall Test RESIDUAL_SKEW (unscaled): 6.228263
2025-11-07 19:00:30,972 - INFO - Overall Test RESIDUAL_KURTOSIS (unscaled): 96.324959
2025-11-07 19:00:30,973 - INFO - Overall Test RESIDUAL_P95 (unscaled): 662.626526
2025-11-07 19:00:30,974 - INFO - Overall Test RESIDUAL_P99 (unscaled): 2621.496582
2025-11-07 19:00:30,975 - INFO - Generating plots and logging to TensorBoard...
2025-11-07 19:00:32,485 - INFO - Main training function finished.
2025-11-07 19:00:32,492 - INFO - Final model saved to runs/run_20251107-184742_Area/final_model/best_model.pt
2025-11-07 19:00:32,493 - INFO - Model configuration saved to runs/run_20251107-184742_Area/final_model/model_config.json
2025-11-07 19:00:32,493 - INFO - --- Run complete ---
2025-11-07 19:00:32,493 - INFO - To view Optuna results: optuna-dashboard sqlite:///runs/optuna_study.db
2025-11-07 19:00:32,493 - INFO - To view TensorBoard logs: tensorboard --logdir runs/run_20251107-184742_Area/
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
NeuralNetwork                            [64, 1]                   --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-1                       [64, 230]                 2,300
│    └─GELU: 2-2                         [64, 230]                 --
├─Dropout: 1-2                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-3                       [64, 230]                 53,130
│    └─GELU: 2-4                         [64, 230]                 --
├─Dropout: 1-4                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-5                       [64, 230]                 53,130
│    └─GELU: 2-6                         [64, 230]                 --
├─Dropout: 1-6                           [64, 230]                 --
├─ModuleList: 1-7                        --                        (recursive)
│    └─Linear: 2-7                       [64, 1]                   231
==========================================================================================
Total params: 108,791
Trainable params: 108,791
Non-trainable params: 0
Total mult-adds (Units.MEGABYTES): 6.96
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.35
Params size (MB): 0.44
Estimated Total Size (MB): 0.79
==========================================================================================
Job finished with exit code: 0
