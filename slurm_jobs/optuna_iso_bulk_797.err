/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-18 23:52:29.159196: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-18 23:52:29.159196: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-18 23:52:30.995440: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-18 23:52:32.566805: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/torch/cuda/__init__.py:61: FutureWarning: The pynvml package is deprecated. Please install nvidia-ml-py instead. If you did not install pynvml directly, please report this to the maintainers of the package that installed pynvml for you.
  import pynvml  # type: ignore[import]
2025-11-18 23:52:34.528517: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2025-11-18 23:52:35,952 - INFO - Using device: cuda
2025-11-18 23:52:35,953 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-18 23:52:35,955 - INFO - Optuna config -> study: nn_study_isotherm_bulk | storage: sqlite:///runs/optuna_isotherm_bulk.db | trials: 1429 | n_jobs: 1
2025-11-18 23:52:35,955 - INFO - Starting Optuna study: nn_study_isotherm_bulk...
2025-11-18 23:52:35,967 - INFO - Using device: cuda
2025-11-18 23:52:35,969 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-18 23:52:35,970 - INFO - Optuna config -> study: nn_study_isotherm_bulk | storage: sqlite:///runs/optuna_isotherm_bulk.db | trials: 1429 | n_jobs: 1
2025-11-18 23:52:35,970 - INFO - Starting Optuna study: nn_study_isotherm_bulk...
2025-11-18 23:52:35,973 - INFO - Using device: cuda
2025-11-18 23:52:35,974 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-18 23:52:35,976 - INFO - Optuna config -> study: nn_study_isotherm_bulk | storage: sqlite:///runs/optuna_isotherm_bulk.db | trials: 1429 | n_jobs: 1
2025-11-18 23:52:35,976 - INFO - Starting Optuna study: nn_study_isotherm_bulk...
2025-11-18 23:52:36.561894: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
[I 2025-11-18 23:52:36,971] Using an existing study with name 'nn_study_isotherm_bulk' instead of creating a new one.
[I 2025-11-18 23:52:36,980] Using an existing study with name 'nn_study_isotherm_bulk' instead of creating a new one.
[I 2025-11-18 23:52:36,985] Using an existing study with name 'nn_study_isotherm_bulk' instead of creating a new one.
[W 2025-11-18 23:52:37,230] Trial 0 failed with parameters: {'batch_size': 256, 'nr_hidden_layers': 4, 'activation_name': 'GELU', 'loss_criterion': 'L1', 'learning_rate': 0.0008617057006977208, 'nr_neurons': 77, 'dropout_rate': 0.43871360404538917, 'weight_decay': 0.00021551574537372024, 'feature_scaler': 'quantile', 'label_scaler': 'standard', 'std_with_mean': True, 'std_with_std': False} because of the following error: UnboundLocalError("cannot access local variable 'X_train' where it is not associated with a value").
Traceback (most recent call last):
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/barattts/lavoltabuona/BA/optuna_objective.py", line 109, in objective
    quantile_n_q = trial.suggest_int("quantile_n_q", 50, min(1000, X_train.shape[0]))
                                                                   ^^^^^^^
UnboundLocalError: cannot access local variable 'X_train' where it is not associated with a value
[W 2025-11-18 23:52:37,232] Trial 0 failed with value None.
Traceback (most recent call last):
  File "/home/barattts/lavoltabuona/BA/run_optuna.py", line 127, in <module>
    main()
  File "/home/barattts/lavoltabuona/BA/run_optuna.py", line 113, in main
    study.optimize(objective_fn, n_trials=optuna_n_trials, n_jobs=optuna_n_jobs)
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/barattts/lavoltabuona/BA/optuna_objective.py", line 109, in objective
    quantile_n_q = trial.suggest_int("quantile_n_q", 50, min(1000, X_train.shape[0]))
                                                                   ^^^^^^^
UnboundLocalError: cannot access local variable 'X_train' where it is not associated with a value
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/distributions.py:518: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains [0.0, 1.0] which is of type list.
  warnings.warn(message)
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/distributions.py:518: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains [-1.0, 1.0] which is of type list.
  warnings.warn(message)
[W 2025-11-18 23:52:37,262] Trial 2 failed with parameters: {'batch_size': 256, 'nr_hidden_layers': 4, 'activation_name': 'SiLU', 'loss_criterion': 'MSE', 'learning_rate': 0.00254902915705545, 'nr_neurons': 77, 'dropout_rate': 0.042679085675379036, 'weight_decay': 0.0006668096112509641, 'feature_scaler': 'quantile', 'label_scaler': 'none'} because of the following error: UnboundLocalError("cannot access local variable 'X_train' where it is not associated with a value").
Traceback (most recent call last):
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/barattts/lavoltabuona/BA/optuna_objective.py", line 109, in objective
    quantile_n_q = trial.suggest_int("quantile_n_q", 50, min(1000, X_train.shape[0]))
                                                                   ^^^^^^^
UnboundLocalError: cannot access local variable 'X_train' where it is not associated with a value
[W 2025-11-18 23:52:37,264] Trial 2 failed with value None.
Traceback (most recent call last):
  File "/home/barattts/lavoltabuona/BA/run_optuna.py", line 127, in <module>
    main()
  File "/home/barattts/lavoltabuona/BA/run_optuna.py", line 113, in main
    study.optimize(objective_fn, n_trials=optuna_n_trials, n_jobs=optuna_n_jobs)
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/study.py", line 490, in optimize
    _optimize(
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 63, in _optimize
    _optimize_sequential(
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 160, in _optimize_sequential
    frozen_trial_id = _run_trial(study, func, catch)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 258, in _run_trial
    raise func_err
  File "/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/study/_optimize.py", line 201, in _run_trial
    value_or_values = func(trial)
                      ^^^^^^^^^^^
  File "/home/barattts/lavoltabuona/BA/optuna_objective.py", line 109, in objective
    quantile_n_q = trial.suggest_int("quantile_n_q", 50, min(1000, X_train.shape[0]))
                                                                   ^^^^^^^
UnboundLocalError: cannot access local variable 'X_train' where it is not associated with a value
2025-11-18 23:52:37,896 - INFO - Using device: cuda
2025-11-18 23:52:37,897 - INFO - Target labels for this run: ['Area', 'Iso_distance', 'Iso_width']
2025-11-18 23:52:37,898 - INFO - Optuna config -> study: nn_study_isotherm_bulk | storage: sqlite:///runs/optuna_isotherm_bulk.db | trials: 1429 | n_jobs: 1
2025-11-18 23:52:37,898 - INFO - Starting Optuna study: nn_study_isotherm_bulk...
[I 2025-11-18 23:52:38,740] Using an existing study with name 'nn_study_isotherm_bulk' instead of creating a new one.
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/distributions.py:518: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains [0.0, 1.0] which is of type list.
  warnings.warn(message)
/home/barattts/lavoltabuona/BA/.venv/daicheelavoltabuona/lib/python3.12/site-packages/optuna/distributions.py:518: UserWarning: Choices for a categorical distribution should be a tuple of None, bool, int, float and str for persistent storage but contains [-1.0, 1.0] which is of type list.
  warnings.warn(message)
2025-11-18 23:52:38.782986: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
srun: error: argon-gtx: task 0: Exited with exit code 1
